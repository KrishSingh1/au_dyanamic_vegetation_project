return(strsplit(str, split = ".", fixed = T)[[1]][1])
})
rownames(max.adj.r2.df) <- 1:nrow(max.adj.r2.df)
r2.map <- merge(annual.precip.data, max.adj.r2.df, by =  "site_location_name")
classifications <- read.csv("../DATASETS/AusPlots_Sites_Classified_2-0-6.csv")
r2.map <- merge(r2.map, classifications, by = 'site_location_name')
View(adj.r2s)
View(max.adj.r2.df)
ggplot(r2.map, mapping = aes(x = window, y = max.adj.r2)) + geom_point() +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window, y = max.adj.r2)) + geom_histogram() +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram() +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(binwidth = 30) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(binwidth = 5) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(binwidth = 40) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(binwidth = 50) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(binwidth = 60) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(bins = 10,binwidth = 60) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(bins = 10) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = window)) + geom_histogram(bins = 15) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = precip_mean, y = window)) + geom_histogram(bins = 15) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = precip_mean, y = window)) + geom_point(bins = 15) +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = precip_mean, y = window)) + geom_point() +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = precip_cv, y = max.adj.r2)) + geom_point() +
facet_wrap(~vegetation_type)
ggplot(r2.map, mapping = aes(x = precip_mean, y = max.adj.r2)) + geom_point() +
facet_wrap(~vegetation_type)
apply_sliding_window <- function(file, window, lag = 0) {
test.zoo <- read.zoo(file, index.column = 'time')
# Create a custom rolling sum function with lag
custom_rollsum <- function(x) {
sum(c(rep(NA, lag), head(x, -lag)), na.rm = TRUE)
}
window.sum <- rollapply(test.zoo, width = window + lag, FUN = custom_rollsum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
apply_sliding_window <- function(file, window, lag = 0) {
test.zoo <- read.zoo(file, index.column = 'time')
# Create a custom rolling sum function with lag
custom_rollsum <- function(x) {
sum(c(rep(NA, lag), head(x, -lag)), na.rm = TRUE)
}
window.sum <- rollapply(test.zoo, width = window + lag, FUN = custom_rollsum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory)
library(ncdf4)
library(zoo)
library(TSstudio)
library(dplyr)
library(plotly)
library(foreach)
library(doParallel)
library(data.table)
# Functions ---------------------------------------------------------------
apply_sliding_window <- function(file, window) {
test.zoo <- read.zoo(file, index.column = 'time')
window.sum <- rollsum(test.zoo, k = window, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
get_precip_data <- function(site.focus, directory) {
precip.path <- file.path(directory, "precip")
nc.path <- file.path(precip.path, paste0(site.focus, "_1987_2022.nc"))
nc <- nc_open(filename = nc.path)
time.var <- ncvar_get(nc, "time")
dates <- as.Date(time.var, origin = "1850-01-01")
var <- ncvar_get(nc, 'precip')
daily.precip <- data.table(precip = var, time = dates)
return(daily.precip)
}
test.window <- function(window, site.focus, directory, site.greenness, precip.data) {
precip.window <- apply_sliding_window(precip.data, window)
colnames(precip.window)[1] <- 'date'
precip.window$date <- as.Date(precip.window$date)
test <- precip.window %>% full_join(site.greenness, by = 'date')
test <- test[order(test$date),]
rownames(test) <- 1:nrow(test)
test <- aggregate(test[,c('window.sum', 'pv')],
by = list(test$date), FUN = mean, na.rm = T)
model <- lm(pv ~ window.sum, data = test)
ret <- c("window" =  window, summary(model)$adj.r.squared)
name.score <- paste0(site.focus, ".adjusted.R2")
names(ret) <- c("window", name.score)
return(ret)
}
fit_linear_models_2 <- function(site.names, windows,
directory = "C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd",
num_cores = 4) {
registerDoParallel(cores = num_cores)
first <- foreach(ssn = site.subset.names, .combine = cbind, .export = c("test.window", "get_precip_data", "windows", "directory", "apply_sliding_window"),
.packages = c("ncdf4", "zoo", "dplyr", "data.table")) %dopar% {
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', ssn, '.csv'), select = c("time", "pv", "npv", ""))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data(ssn, directory)
site.r2 <- data.table(t(sapply(windows, FUN = test.window,
site.focus = ssn,
directory = directory,
site.greenness = site.greenness,
precip.data = precip.data)))
return(site.r2)
}
stopImplicitCluster()
return(first)
}
apply_sliding_window <- function(file, window, lag = 0) {
test.zoo <- read.zoo(file, index.column = 'time')
# Create a custom rolling sum function with lag
custom_rollsum <- function(x) {
sum(c(rep(NA, lag), head(x, -lag)), na.rm = TRUE)
}
window.sum <- rollapply(test.zoo, width = window + lag, FUN = custom_rollsum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
View(precip.data)
precip.window <- apply_sliding_window(precip.data, window = 10)
View(precip.window)
View(precip.window)
apply_sliding_window <- function(file, window, lag = 1) {
test.zoo <- read.zoo(file, index.column = 'time')
# Create a custom rolling sum function with lag
custom_rollsum <- function(x) {
sum(c(rep(NA, lag), head(x, -lag)), na.rm = TRUE)
}
window.sum <- rollapply(test.zoo, width = window + lag, FUN = custom_rollsum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window(precip.data, window = 10)
View(precip.window)
apply_sliding_window <- function(file, window, lag = 10) {
test.zoo <- read.zoo(file, index.column = 'time')
# Create a custom rolling sum function with lag
custom_rollsum <- function(x) {
sum(c(rep(NA, lag), head(x, -lag)), na.rm = TRUE)
}
window.sum <- rollapply(test.zoo, width = window + lag, FUN = custom_rollsum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
apply_sliding_window <- function(file, window, lag = 10) {
file$lagged <- dplyr::lag(file$precip, n=4)
test.zoo <- read.zoo(file, index.column = 'time')
window.sum <- rollapply(test.zoo, width = window, FUN = custom_rollsum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window(precip.data, window = 10)
apply_sliding_window <- function(file, window, lag = 10) {
file$lagged <- dplyr::lag(file$precip, n=4)
test.zoo <- read.zoo(file, index.column = 'time')
window.sum <- rollapply(test.zoo, width = window, FUN = sum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window(precip.data, window = 10)
View(precip.window)
apply_sliding_window <- function(file, window, lag = 10) {
file$lagged <- dplyr::lag(file$precip, n=4)
test.zoo <- read.zoo(file, index.column = 'time')
window.sum <- rollapply(test.zoo, width = window, FUN = sum, align = 'Left', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window(precip.data, window = 10)
apply_sliding_window <- function(file, window, lag = 10) {
file$lagged <- dplyr::lag(file$precip, n=4)
test.zoo <- read.zoo(file, index.column = 'time')
window.sum <- rollapply(test.zoo, width = window, FUN = sum, align = 'left', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window(precip.data, window = 10)
apply_sliding_window <- function(file, window, lag = 10) {
file$lagged <- dplyr::lag(file$precip, n=4)
test.zoo <- read.zoo(file, index.column = 'time')
window.sum <- rollapply(test.zoo, width = window, FUN = sum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window(precip.data, window = 10)
apply_sliding_window <- function(file, window, lag = 0) {
file$lagged <- dplyr::lag(file$precip, n=lag)
test.zoo <- read.zoo(file, index.column = 'time')
window.sum <- rollapply(test.zoo, width = window, FUN = sum, align = 'right', fill = NA)
result <- data.table(
date = index(window.sum),
window.sum = coredata(window.sum)
)
return(result)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window(precip.data, window = 10, lag = 3)
View(precip.data)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
t <- 1
i <- 0
while(t + window < rows){
print(sum(file$precip[(1 + i):t]))
t <- t+ window
}
}
precip.window <- apply_sliding_window(precip.data, window = 10)
apply_sliding_window(precip.data, window = 10)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
t <- 1
i <- 0
while(t + window < rows){
print(sum(file$precip[(1 + i):t]))
t <- t+ window
}
}
apply_sliding_window(precip.data, window = 10)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
t <- 1
i <- 0
while(t + window < rows){
print(sum(file$precip[(1 + i):t]))
t <- t+ window
}
}
apply_sliding_window_2(precip.data, window = 10)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
t <- 1
i <- 0
while(t + window < rows){
print(sum(file$precip[(1 + i):(i+window)]))
}
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window_2(precip.data, window = 10)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
t <- 1
i <- 0
while(i + window< rows){
print(sum(file$precip[(1 + i):(i+window)]))
i <- i + 1
}
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
precip.window <- apply_sliding_window_2(precip.data, window = 10)
View(precip.data)
precip.window <- apply_sliding_window(precip.data, window = 10)
View(precip.window)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
i <- 0
precip <- c()
while(i + window< rows){
precip <- c(precip, sum(file$precip[(1 + i):(i+window)]))
print(paste0(1+i,":",i+window))
i <- i + 1
}
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
apply_sliding_window(precip.data, window = 10)
apply_sliding_window_2(precip.data, window = 10)
View(precip.data)
View(precip.window)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
i <- 0
precip <- c()
while(i + window< rows){
precip <- c(precip, sum(file$precip[(1 + i):(i+window)]))
print(paste0(1+i,":",i+window))
i <- i + 1
}
return(precip)
}
rest <- apply_sliding_window_2(precip.data, window = 10)
rest - precip.window$window.sum.precip
length(precip.window$window.sum.precip)
length(rest) - length(precip.window$window.sum.precip)
length(rest)
rest - na.omit(precip.window$window.sum.precip)
rest - na.omit(precip.window$window.sum.precip)
na.omit(precip.window$window.sum.precip)
rest - na.omit(precip.window$window.sum.precip)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
i <- 0
precip <- c()
while(i + window <= rows){
precip <- c(precip, sum(file$precip[(1 + i):(i+window)]))
print(paste0(1+i,":",i+window))
i <- i + 1
}
precip <- c(rep(NA, window), precip)
return(precip)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
rest <- apply_sliding_window_2(precip.data, window = 10)
rest - na.omit(precip.window$window.sum.precip)
View(precip.window)
print(rest)
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
i <- 0
precip <- c()
while(i + window <= rows){
precip <- c(precip, sum(file$precip[(1 + i):(i+window)]))
print(paste0(1+i,":",i+window))
i <- i + 1
}
precip <- c(rep(NA, window-1), precip)
return(precip)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
rest <- apply_sliding_window_2(precip.data, window = 10)
precip.window <- apply_sliding_window(precip.data, window = 10)
rest - na.omit(precip.window$window.sum.precip)
rest - precip.window$window.sum.precip
apply_sliding_window_2 <- function(file, window, lag = 0) {
rows <- nrow(file)
i <- 0
precip <- c()
while(i + window <= rows){
precip <- c(precip, sum(file$precip[(1 + i):(i+window)]))
print(paste0(1+i,":",i+window))
i <- i + 1
}
precip <- c(rep(NA, window-1), precip)
file$precip.window <- precip
return(file)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
rest <- apply_sliding_window_2(precip.data, window = 10)
View(rest)
View(precip.window)
rest - precip.window$window.sum.precip
apply_sliding_window_3 <- function(file, window, lag = 1) {
rows <- nrow(file)
i <- 0 - lag
precip <- c()
file$file.index <- rownames(file)
while(i + window <= rows) {
indices <- (1 + i):(i+window)
temp <- subset(file, subset = (file.index %in% indices))
print(temp)
precip <- c(precip, sum(temp$precip))
#print(paste0(1+i,":",i+window))
i <- i + 1
}
precip <- c(rep(NA, window-1), precip)
file$precip.window <- precip
return(file)
}
rest.1 <- apply_sliding_window_3(precip.data, window = 10)
apply_sliding_window_3 <- function(file, window, lag = 1) {
rows <- nrow(file)
i <- 0 - lag
precip <- c()
file$file.index <- rownames(file)
while(i + window <= rows) {
indices <- (1 + i):(i+window)
temp <- subset(file, subset = (file.index %in% indices))
print(temp)
precip <- c(precip, sum(temp$precip))
#print(paste0(1+i,":",i+window))
i <- i + 1
}
precip <- c(rep(NA, window-lag - 1), precip)
file$precip.window <- precip
return(file)
}
site.greenness <- fread(paste0('../DATASETS/DEA_FC_PROCESSED/SPATIAL_AND_UE_FILTER/', 'TCATCH0006', '.csv'), select = c("time", "pv"))
colnames(site.greenness)[colnames(site.greenness) == "time"] <- "date"
site.greenness$date <- as.Date(site.greenness$date)
precip.data <- get_precip_data('TCATCH0006', directory =
"C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/DataExtraction/BACKUP_DATA/ausplots_agcd")
rest <- apply_sliding_window_2(precip.data, window = 10)
rest.1 <- apply_sliding_window_3(precip.data, window = 10)
precip.window <- apply_sliding_window(precip.data, window = 10)
View(rest)
View(rest.1)
apply_sliding_window_3 <- function(file, window, lag = 1) {
rows <- nrow(file)
i <- 0 - lag
precip <- c()
file$file.index <- rownames(file)
while(i + window <= rows) {
indices <- (1 + i):(i+window)
temp <- subset(file, subset = (file.index %in% indices))
precip <- c(precip, sum(temp$precip))
i <- i + 1
}
precip <- c(rep(NA, window-lag - 1), precip)
file$precip.window <- precip
return(file)
}
rest.1 <- apply_sliding_window_3(precip.data, window = 10)
