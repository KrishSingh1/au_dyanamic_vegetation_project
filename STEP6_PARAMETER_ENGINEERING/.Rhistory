spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.37)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "periodic", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.38)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.40)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.6)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.3)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.4)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.49)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.45)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.40)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.60)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
?spline.fit
?smooth.spline
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.60, df = 5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.4, df = 5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.5, df = 5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.6, df = 5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.6, df = 6)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit.npv <- data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y)
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.6, df = 6)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.6, df = 100)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.6)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv,spar = 0.6, cv = T)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, all.knots = T)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, all.knots = T, spar = 0.4)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, all.knots = T, spar = 0.4)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 0.5, spar = 0.4)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 0.1, spar = 0.4)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 1, spar = 0.4)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 10, spar = 0.4)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 10, spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'trace')
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol')
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.6)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.59)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
library(mgcv)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
?spline
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "fmm", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "n", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
library(ggplot2)
library(zoo)
library(mgcv)
?s
model <- gam(npv ~ s(time), data = fc.npv)
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
model <- gam(npv ~ s(time), data = fc.npv)
s(time)
model <- gam(npv ~ time, data = fc.npv)
predict(model, newdata = daily.dates)
predict(model, newdata = daily.dates)
model <- gam(npv ~ s(time), data = fc.npv)
model <- gam(npv ~ s(time), data = na.omit(fc.npv))
model <- gam(npv ~ s(time), data = na.omit(fc.npv))
predict(model, newdata = fc.npv)
plot(predict(model, newdata = fc.npv))
model <- gam(npv ~ S(time), data = fc.npv)
model <- gam(npv ~ s(time), data = fc.npv)
set.seed(123)
time_points <- 1:100
original_data <- sin(0.1 * time_points) + rnorm(100, sd = 0.2)
missing_indices <- sample(1:100, size = 20)
original_data[missing_indices] <- NA
# Create a data frame with time and the original data
data_df <- data.frame(time = time_points, value = original_data)
# Fit a GAM model to the data
gam_model <- gam(value ~ s(time), data = data_df)
# Predict the missing values using the fitted model
filled_values <- predict(gam_model, newdata = data_df)
# Replace the missing values with the predicted values
data_df$value[is.na(data_df$value)] <- filled_values[is.na(data_df$value)]
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
model <- gam(npv ~ s(time), data = fc.npv)
plot(predict(model, newdata = fc.npv))
model <- gam(npv ~ s(time), data = fc.npv)
str(fc.npv)
summary(fc.npv)
fc.npv <- fc[,c("time", "npv")]
model <- gam(npv ~ s(as.numeric(time)), data = fc.npv)
plot(predict(model, newdata = fc.npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
plot(predict(model, newdata = fc.npv))
model <- gam(npv ~ s(as.numeric(time)), data = fc.npv,gamma = 0.5)
plot(predict(model, newdata = fc.npv))
model <- gam(npv ~ s(as.numeric(time)), data = fc.npv,gamma = 0.1)
plot(predict(model, newdata = fc.npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
model <- gam(npv ~ s(as.numeric(time)), data = fc.npv,gamma = 0.1)
plot(predict(model, newdata = fc.npv))
model
View(model)
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "n", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
?spline
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "h", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "h", xout = daily.dates)
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
smoothed_data <- stats::lowess(fc.npv$npv, fc.npv$time)
View(smoothed_data)
plot(smoothed_data)
smoothed_data <- stats::lowess(fc.npv$npv, fc.npv$time)
plot(smoothed_data)
smoothed_data <- stats::lowess(fc.npv$time,fc.npv$npv)
plot(smoothed_data)
smoothed_data <- stats::lowess(fc.npv$npv)
plot(smoothed_data)
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- smooth.spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- smooth.spline(x = fc$time, y = fc$npv)
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit.npv <- data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y)
spline.fit.npv$diff <- c(NA, diff(spline.fit.npv$npv))
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv)) +
geom_line(data = spline.fit.npv,mapping = aes(x = time, y = diff), color = 'green')
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv)) +
geom_line(data = spline.fit.npv,mapping = aes(x = time, y = diff), color = 'brown')
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, penalty = 100, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit.npv <- data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y)
spline.fit.npv$diff <- c(NA, diff(spline.fit.npv$npv))
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv)) +
geom_line(data = spline.fit.npv,mapping = aes(x = time, y = diff), color = 'brown')
View(spline.fit.npv)
View(spline.fit.pv)
source("C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/au_dyanamic_vegetation_project/STEP7_RATE_OF_CHANGE/Sturt_Plains_Change.R")
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit <- smooth.spline(fc.pv$time, fc.pv$pv,spar = 0.37)
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit <- smooth.spline(fc.pv$time, fc.pv$pv,spar = 0.37)
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit <- smooth.spline(fc.pv$time, fc.pv$pv,spar = 0.37, method = 'periodic')
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit <- smooth.spline(fc.pv$time, fc.pv$pv,spar = 0.37)
spline.fit$x <- as.Date(spline.fit$x)
library(ggplot2)
library(zoo)
library(mgcv)
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit <- smooth.spline(fc.pv$time, fc.pv$pv,spar = 0.37)
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc.pv$time), max(fc.pv$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc$time), max(fc$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit <- smooth.spline(fc.pv$time, fc.pv$pv,spar = 0.37)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"pv" = spline.fit$y), mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit.pv <- data.frame("time" = as.Date(spline.fit$x),"pv" = spline.fit$y)
spline.fit.pv$diff <- c(NA, diff(spline.fit.pv$pv))
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"pv" = spline.fit$y), mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv)) +
geom_line(data = spline.fit.pv,mapping = aes(x = time, y = diff), color = 'green')
daily.dates <- seq(min(fc$time), max(fc$time), by = "1 day")
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
fc.npv <- fc[,c("time", "npv")]
fc <- read.csv('../DATASETS/Sturt_Plains_DEA_FC/Output/Sturt Plains.csv')
fc$time <- as.Date(fc$time)
ggplot(fc) + geom_line(mapping = aes(x = time, y = pv))
daily.dates <- seq(min(fc$time), max(fc$time), by = "1 day")
fc.pv <- fc[,c("time", "pv")]
fc.pv <- spline(x = fc$time, y = fc$pv, method = "periodic", xout = daily.dates)
fc.pv <- data.frame("time" = as.Date(fc.pv$x), "pv" = fc.pv$y)
ggplot() +geom_line(data = fc.pv, mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit <- smooth.spline(fc.pv$time, fc.pv$pv,spar = 0.37)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"pv" = spline.fit$y), mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv))
spline.fit.pv <- data.frame("time" = as.Date(spline.fit$x),"pv" = spline.fit$y)
spline.fit.pv$diff <- c(NA, diff(spline.fit.pv$pv))
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"pv" = spline.fit$y), mapping = aes(x = time, y = pv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = pv)) +
geom_line(data = spline.fit.pv,mapping = aes(x = time, y = diff), color = 'green')
daily.dates <- seq(min(fc$time), max(fc$time), by = "1 day")
ggplot(fc) + geom_line(mapping = aes(x = time, y = npv))
fc.npv <- fc[,c("time", "npv")]
fc.npv <- spline(x = fc$time, y = fc$npv, method = "p", xout = daily.dates)
fc.npv <- data.frame("time" = as.Date(fc.npv$x), "npv" = fc.npv$y)
ggplot() +geom_line(data = fc.npv, mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit <- smooth.spline(fc.npv$time, fc.npv$npv, control.spar = 'tol', spar = 0.5)
spline.fit$x <- as.Date(spline.fit$x)
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv))
spline.fit.npv <- data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y)
spline.fit.npv$diff <- c(NA, diff(spline.fit.npv$npv))
ggplot() +geom_line(data = data.frame("time" = as.Date(spline.fit$x),"npv" = spline.fit$y), mapping = aes(x = time, y = npv), color = 'red') +
geom_line(data = fc,mapping = aes(x = time, y = npv)) +
geom_line(data = spline.fit.npv,mapping = aes(x = time, y = diff), color = 'brown')
source("C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/au_dyanamic_vegetation_project/STEP7_RATE_OF_CHANGE/Sturt_Plains_Change.R")
write.csv(spline.fit.pv,'../DATASETS/spline_fit_pv.csv')
source("C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/au_dyanamic_vegetation_project/STEP7_RATE_OF_CHANGE/Sturt_Plains_Change.R")
source("C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/au_dyanamic_vegetation_project/STEP7_RATE_OF_CHANGE/Sturt_Plains_Change.R")
source("C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/au_dyanamic_vegetation_project/STEP7_RATE_OF_CHANGE/Sturt_Plains_Change.R")
source("C:/Users/krish/Desktop/DYNAMIC MODEL VEGETATION PROJECT/au_dyanamic_vegetation_project/STEP7_RATE_OF_CHANGE/Sturt_Plains_Change.R")
View(fc.npv)
View(fc.pv)
View(spline.fit.npv)
?diff
48.67432 - 47.97917
47.97917 -48.67432
47.28321 - 47.97917
47.28321 -47.97917
46.58708 - 47.28321
45.89143
- 46.58708
45.19690 - 45.89143
